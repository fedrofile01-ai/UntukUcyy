<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Kunci Cintaku</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        margin: 0;
        height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        background: radial-gradient(
          circle at 30% 30%,
          #1b1645,
          #0b0822 60%,
          #050414 100%
        );
        font-family: Poppins, sans-serif;
        color: #fff;
        overflow: hidden;
        padding: env(safe-area-inset-top) env(safe-area-inset-right)
          env(safe-area-inset-bottom) env(safe-area-inset-left);
      }
      #bgHearts {
        position: fixed;
        inset: 0;
        z-index: -1;
      }
      .card {
        padding: 28px;
        border-radius: 20px;
        background: rgba(255, 255, 255, 0.06);
        backdrop-filter: blur(8px);
        box-shadow: 0 20px 50px rgba(0, 0, 0, 0.6);
        width: min(92vw, 360px);
        text-align: center;
      }
      h1 {
        margin: 0 0 14px;
        font-size: clamp(1.4rem, 5vw, 2rem);
        color: #ff6b81;
      }
      .screen {
        margin: 0 auto 16px;
        padding: 14px;
        border-radius: 14px;
        background: rgba(255, 255, 255, 0.1);
        font-size: clamp(1.2rem, 5vw, 1.6rem);
        letter-spacing: 8px;
        width: 80%;
        text-align: center;
      }
      .grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 14px;
        justify-items: center;
        align-items: center;
        margin-bottom: 16px;
      }
      .btn {
        display: flex;
        align-items: center;
        justify-content: center;
        border: none;
        border-radius: 14px;
        width: clamp(60px, 22vw, 80px);
        height: clamp(55px, 18vw, 70px);
        font-size: clamp(1rem, 4vw, 1.3rem);
        background: linear-gradient(180deg, #2a2848, #171633);
        color: #fff;
        cursor: pointer;
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.6);
        transition: transform 0.2s;
      }
      .btn:hover {
        transform: scale(1.05);
      }
      .enter-btn {
        display: block;
        margin: 10px auto 0;
        height: clamp(50px, 16vw, 58px);
        width: 100%;
        background: linear-gradient(90deg, #ff6b81, #ff9aa2);
      }
      .status {
        margin-top: 8px;
        min-height: 22px;
        font-weight: 600;
        font-size: clamp(0.9rem, 3vw, 1rem);
      }
      .shake {
        animation: shake 0.4s;
      }
      @keyframes shake {
        20% {
          transform: translateX(-5px);
        }
        40% {
          transform: translateX(5px);
        }
        60% {
          transform: translateX(-3px);
        }
        80% {
          transform: translateX(3px);
        }
      }

      /* üì± Landscape mode */
      @media screen and (orientation: landscape) {
        .card {
          width: 70vw;
          max-width: 500px;
        }
        .btn {
          width: clamp(50px, 15vw, 70px);
          height: clamp(45px, 12vw, 60px);
          font-size: clamp(0.9rem, 2.5vw, 1.1rem);
        }
        .enter-btn {
          height: clamp(45px, 12vw, 55px);
        }
        h1 {
          font-size: clamp(1.2rem, 4vw, 1.6rem);
        }
        .screen {
          font-size: clamp(1rem, 4vw, 1.3rem);
        }
      }
    </style>
  </head>
  <body>
    <canvas id="bgHearts"></canvas>
    <div class="card" id="card">
      <h1>Masukkan Kode</h1>
      <div class="screen" id="screen">______</div>

      <div class="grid" id="keypad">
        <button class="btn">1</button>
        <button class="btn">2</button>
        <button class="btn">3</button>
        <button class="btn">4</button>
        <button class="btn">5</button>
        <button class="btn">6</button>
        <button class="btn">7</button>
        <button class="btn">8</button>
        <button class="btn">9</button>
        <button class="btn" id="backBtn">‚å´</button>
        <button class="btn">0</button>
        <button class="btn" id="hintBtn">?</button>
      </div>

      <button class="btn enter-btn" id="enterBtn">ENTER</button>
      <div class="status" id="status"></div>
    </div>

    <audio id="bgAudio" autoplay loop muted>
      <source
        src="https://www.bensound.com/bensound-music/bensound-romantic.mp3"
        type="audio/mpeg"
      />
    </audio>
    <audio
      id="clickSound"
      src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg"
    ></audio>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
    <script>
      const correctCode = "241105";
      let inputCode = "";
      const screen = document.getElementById("screen");
      const status = document.getElementById("status");
      const card = document.getElementById("card");
      const bgAudio = document.getElementById("bgAudio");
      const clickSound = document.getElementById("clickSound");

      function ensureMusic() {
        if (bgAudio.muted) {
          bgAudio.muted = false;
          bgAudio.play().catch(() => {});
        }
      }
      function playClick() {
        clickSound.currentTime = 0;
        clickSound.play().catch(() => {});
      }

      document.querySelectorAll("#keypad .btn").forEach((btn) => {
        btn.onclick = () => {
          if (!btn.textContent) return;
          ensureMusic();
          playClick();
          if (btn.id === "backBtn") {
            inputCode = inputCode.slice(0, -1);
          } else if (btn.id === "hintBtn") {
            status.textContent =
              "Hint: tanggal lahir aku, kalo gatau DM aja yaa sayanggg ‚ù§Ô∏è";
            return;
          } else {
            if (inputCode.length < 6) inputCode += btn.textContent;
          }
          updateScreen();
        };
      });

      document.getElementById("enterBtn").onclick = () => {
        playClick();
        ensureMusic();
        if (inputCode.length === 6) {
          if (inputCode === correctCode) {
            status.textContent = "Benar! ‚ù§Ô∏è";
            confetti({ particleCount: 200, spread: 160 });
            setTimeout(() => (location.href = "surprise.html"), 1500);
          } else {
            status.textContent = "Salah kode üòò";
            card.classList.add("shake");
            setTimeout(() => card.classList.remove("shake"), 400);
            inputCode = "";
            updateScreen();
          }
        } else {
          status.textContent = "Kurang angka sayang üòò";
        }
      };
      function updateScreen() {
        screen.textContent = inputCode.padEnd(6, "_");
      }

      // hearts bg
      const c = document.getElementById("bgHearts"),
        g = c.getContext("2d");
      let W, H;
      function resize() {
        W = c.width = innerWidth;
        H = c.height = innerHeight;
      }
      resize();
      addEventListener("resize", resize);
      const hearts = [];
      function spawn() {
        return {
          x: Math.random() * W,
          y: -20,
          s: 0.6 + Math.random() * 1.4,
          v: 1 + Math.random(),
          a: 0.7,
        };
      }
      function draw(x, y, s, a) {
        g.save();
        g.translate(x, y);
        g.scale(s, s);
        g.globalAlpha = a;
        g.beginPath();
        for (let t = 0; t < 7; t += 0.2) {
          const xx = 16 * Math.pow(Math.sin(t), 3),
            yy = -(
              13 * Math.cos(t) -
              5 * Math.cos(2 * t) -
              2 * Math.cos(3 * t) -
              Math.cos(4 * t)
            );
          if (t === 0) g.moveTo(xx, yy);
          else g.lineTo(xx, yy);
        }
        g.closePath();
        g.fillStyle = "rgba(255,107,129,.9)";
        g.fill();
        g.restore();
      }
      function loop() {
        g.clearRect(0, 0, W, H);
        while (hearts.length < 50) hearts.push(spawn());
        hearts.forEach((h) => {
          h.y += h.v;
          h.x += Math.sin(h.y / 40);
          if (h.y > H + 30) {
            h.x = Math.random() * W;
            h.y = -20;
          }
          draw(h.x, h.y, h.s, h.a);
        });
        requestAnimationFrame(loop);
      }
      loop();
    </script>
  </body>
</html>
